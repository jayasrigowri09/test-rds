{
    "AWStemplateFormateVersion": "2010-09-09",
    "Description": "create ec2 and rds",

    "parameters" : {
        "AvailabilityZone" : {
            "Type" : "String",
            "Description" : "Select Azs",
            "Default" : "us-west-1d"
        },

        "ImageId" : {
            "Type" : "String",
            "Description" : "Id of the instance",
            "Default" : ""            
        },

        "KeypairName" : {
            "Type" : "AWS::EC2::Keypair::KeyName"
        },

        "DBInstanceIdentifier" : {
            "Type" : "String",
            "Default" : "Webapp-db"
        },

        "DBUsername" : {
            "Type" : "String",
            "Description" : " Username for Mysql database access",
            "NoEcho" : "true",
            "Default" : "Mysqldb"
        },

        "DbPassword" : {
            "Type" : "String",
            "Description" : "Db password must alphanumeric"
        }
        
    },

    "Resources" : {
        "RDSDEMOVPC" : {
            "Type" : "AWS::EC2::VPC",
            "Properties" : {
                "CidrBlock" : "10.0.0.0/16",
                "EnableDnsSupport" : "true",
                "EnableDnsHostnames" : "true",
                "InstanceDefault" : "default",
                "Tags" : [
                    {
                        "Key" : "Name",
                        "Value" : "Rds-Demo-Vpc"
                    }
                ]

            }
        },

        "PrivateSubnet1" : {
            "Type" : "AWS::Ec2::Subnet",
            "properties" : {
                "AvailabilityZone" : "us-east-1c",
                "VpcId": {  "Ref" : "Rds-Demo-Vpc" },
                "Cidrblock" : "10.0.3.0/24",
                "Tags" : [ {  "Key": "Name", "value" : "Private-subnet-test1" } ]
                    
            }

        },

        "PrivateSubnet2" : {
            "Type" : "AWS::Ec2::Subnet",
            "properties" : {
                "AvailabilityZone" : "us-east-1c",
                "VpcId" : { "Ref" : "Rds-Demo-Vpc" },
                "Cidrblock" : "10.0.3.0/24",
                "Tags" : [ { "Key" : "Name", "value" : "Private-subnet-test2" } ]

            }
        },

        "PublicSubnet1" : {
            "Type" : "AWS::Ec2::Subnet",
            "Properties" : {
                "AvailabilirtZone" : "Us-east-1d",
                "MapPublicOnLaunch" : "true",
                "VpcId" : { "Ref" : "Rds-Demo-vpc" },
                "CidrBlock" : "10.0.1.0/24",
                "Tags" : [ { "Key" : "Name",  "Value" : "Public-sunet_test1" } ]
            }
        },

        "PublicSubnet2" : {
            "Type" : "AWS::Ec2::Subnet",
            "Properties" : {
                "AvailabilirtZone" : "Us-east-1d",
                "VpcId" : { "Ref": "Rds-Demo-vpc" },
                "CidrBlock" : "10.0.2.0/24",
                "Tags" : [ { "Key" : "Name", "Value" : "Public-sunet_test2" } ]
            }
        },

        "PublicRouteTable1" : {
            "Type" : "AWS::EC2::RouteTable",
            "Properties" : {
                "VpcId" : { "Ref" : "Rds-Demo-Vpc" },
                "Tags" : [ { "Key" : "Name",  "value" : "Public-RT1" } ]

            }
        },

        "PublicRouteTable2" : {
            "Type" : "AWS::EC2::RouteTable",
            "Properties" : {
                "VpcId" : { "Ref" : "Rds-Demo-Vpc" },
                "Tags" : [ { "Key" : "Name",  "value" : "Public-RT2" } ]
            }
        },

        "PublicRoute1" : {
            "Type" : "AWS::EC2::Route",
            "Depondson": "InternetGatewayAttachment",
            "Properties": {
                "RouteTableId": { "Ref" : "PublicRouteTable1" },
                "DestinationCidrBlock"  :   "0.0.0.0/0",
                "GatewayId" : { "Ref" : "InternetGateway" }
            }
        },

        "PublicRoute2" : {
            "Type" : "AWS::EC2::Route",
            "Depondson": "InternetGatewayAttachment",
            "Properties": {
                "RouteTableId": { "Ref" : "PublicRouteTable2" },
                "DestinationCidrBlock"  :   "0.0.0.0/0",
                "GatewayId" : { "Ref" : "InternetGateway" }
            }
        },

        "PublicSubnetRouteTableAssociation1" : {
            "Type" : "AWS::EC2::SubetRouteTableAssociation",
            "Properies" : {
                "RouteTableId" : { "Ref" : "PublicRouteTable1" },
                "SubnetId" : { "Ref" : "PublicSubnet1" }
            }
        },

        "PublicSubnetRouteTableAssociation2" : {
            "Type" : "AWS::EC2::SubetRouteTableAssociation",
            "Properies" : {
                "RouteTableId" : { "Ref" : "PublicRouteTable2" },
                "SubnetId" : { "Ref" : "PublicSubnet2" }
            }
        },

        "InternetGateway" : {
            "Type" : "AWS::EC2::InternetGateway",
            "Properties" : {
                "Tags" :[ { "Key" : "Name", "Value" : "Test-IGW" } ]
            }
        },

        "InternetGatewayAttachment" : {
            "Type" : "AWS::EC2::VPCGatewayAttachment",
            "Properties": {
                "InternetGatewayId" : { "REf" : "InternetGateway" },
                "VpcId" : { "Ref" : "Rds-Demo-Vpc"}
            }
        },

        









    }    
        










 
